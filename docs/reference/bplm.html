<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian Piecewise Linear Model — bplm • scan</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Piecewise Linear Model — bplm"><meta name="description" content="Computes a bayesian (hierarchical) piecewise linear model based on a Markov
chain Monte Carlo sampler."><meta property="og:description" content="Computes a bayesian (hierarchical) piecewise linear model based on a Markov
chain Monte Carlo sampler."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.65.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://jazznbass.github.io/scan-Book/">The book</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://jazznbass.github.io/scplot/">scplot</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/jazznbass/scan/"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bayesian Piecewise Linear Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/jazznbass/scan/blob/HEAD/R/bplm.R" class="external-link"><code>R/bplm.R</code></a>, <a href="https://github.com/jazznbass/scan/blob/HEAD/R/print-export-bplm.R" class="external-link"><code>R/print-export-bplm.R</code></a></small>
      <div class="d-none name"><code>bplm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes a bayesian (hierarchical) piecewise linear model based on a Markov
chain Monte Carlo sampler.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bplm</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">dvar</span>,</span>
<span>  <span class="va">pvar</span>,</span>
<span>  <span class="va">mvar</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"W"</span>, <span class="st">"H-M"</span>, <span class="st">"B&amp;L-B"</span><span class="op">)</span>,</span>
<span>  contrast_level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"first"</span>, <span class="st">"preceding"</span><span class="op">)</span>,</span>
<span>  contrast_slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"first"</span>, <span class="st">"preceding"</span><span class="op">)</span>,</span>
<span>  trend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  level <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  slope <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  random_trend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  random_level <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  random_slope <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fixed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  random <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  update_fixed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'sc_bplm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fl">3</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'sc_bplm'</span></span>
<span><span class="fu"><a href="export.html">export</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  caption <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  footnote <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  filename <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  round <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  nice <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A single-case data frame. See <code><a href="scdf.html">scdf()</a></code> to learn about this
format.</p></dd>


<dt id="arg-dvar">dvar<a class="anchor" aria-label="anchor" href="#arg-dvar"></a></dt>
<dd><p>Character string with the name of the dependent variable.
Defaults to the attributes in the scdf file.</p></dd>


<dt id="arg-pvar">pvar<a class="anchor" aria-label="anchor" href="#arg-pvar"></a></dt>
<dd><p>Character string with the name of the phase variable. Defaults to
the attributes in the scdf file.</p></dd>


<dt id="arg-mvar">mvar<a class="anchor" aria-label="anchor" href="#arg-mvar"></a></dt>
<dd><p>Character string with the name of the measurement time variable.
Defaults to the attributes in the scdf file.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Model used for calculating the dummy parameters (see Huitema &amp;
McKean, 2000). Default is <code>model = "W"</code>. Possible values are: <code>"B&amp;L-B"</code>,
<code>"H-M"</code>, <code>"W"</code>, and deprecated <code>"JW"</code>.</p></dd>


<dt id="arg-contrast-level">contrast_level<a class="anchor" aria-label="anchor" href="#arg-contrast-level"></a></dt>
<dd><p>Either "first", "preceding" or a contrast matrix. If NA
contrast_level is a copy of contrast.</p></dd>


<dt id="arg-contrast-slope">contrast_slope<a class="anchor" aria-label="anchor" href="#arg-contrast-slope"></a></dt>
<dd><p>Either "first", "preceding" or a contrast matrix. If NA
contrast_level is a copy of contrast.</p></dd>


<dt id="arg-trend">trend<a class="anchor" aria-label="anchor" href="#arg-trend"></a></dt>
<dd><p>A logical indicating if a trend parameters is included in the
model.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>A logical indicating if a level parameters is included in the
model.</p></dd>


<dt id="arg-slope">slope<a class="anchor" aria-label="anchor" href="#arg-slope"></a></dt>
<dd><p>A logical indicating if a slope parameters is included in the
model.</p></dd>


<dt id="arg-random-trend">random_trend<a class="anchor" aria-label="anchor" href="#arg-random-trend"></a></dt>
<dd><p>If TRUE, includes a random trend effect.</p></dd>


<dt id="arg-random-level">random_level<a class="anchor" aria-label="anchor" href="#arg-random-level"></a></dt>
<dd><p>If TRUE, includes a random level effect.</p></dd>


<dt id="arg-random-slope">random_slope<a class="anchor" aria-label="anchor" href="#arg-random-slope"></a></dt>
<dd><p>If TRUE, includes a random slope effect.</p></dd>


<dt id="arg-fixed">fixed<a class="anchor" aria-label="anchor" href="#arg-fixed"></a></dt>
<dd><p>A formula that overwrites the automatically created fixed part
of the regression model that defaults to the standard piecewise regression
model. The parameter phase followed by the phase name (e.g., phaseB)
indicates the level effect of the corresponding phase. The parameter
'inter' followed by the phase name (e.g., interB) adresses the slope effect
based on the method provide in the model argument (e.g., "B&amp;L-B"). The
formula can be changed for example to include further L1 or L2 variables
into the regression model.</p></dd>


<dt id="arg-random">random<a class="anchor" aria-label="anchor" href="#arg-random"></a></dt>
<dd><p>A formula that overwrites the automatically created random part
of the regression model.</p></dd>


<dt id="arg-update-fixed">update_fixed<a class="anchor" aria-label="anchor" href="#arg-update-fixed"></a></dt>
<dd><p>An easier way to change the fixed model part (e.g., <code>. ~ . + newvariable</code>).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to the mcmcglmm function.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object returned by <code>bplm()</code></p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>The minimum number of significant digits to be use.
If set to "auto" (default), values are predefined.</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An scdf or an object exported from a scan function.</p></dd>


<dt id="arg-caption">caption<a class="anchor" aria-label="anchor" href="#arg-caption"></a></dt>
<dd><p>Character string with table caption. If left NA (default) a
caption will be created based on the exported object.</p></dd>


<dt id="arg-footnote">footnote<a class="anchor" aria-label="anchor" href="#arg-footnote"></a></dt>
<dd><p>Character string with table footnote. If left NA (default) a
footnote will be created based on the exported object.</p></dd>


<dt id="arg-filename">filename<a class="anchor" aria-label="anchor" href="#arg-filename"></a></dt>
<dd><p>String containing the file name. If a filename is given the
output will be written to that file.</p></dd>


<dt id="arg-round">round<a class="anchor" aria-label="anchor" href="#arg-round"></a></dt>
<dd><p>Integer passed to the digits argument internally used to round
values.</p></dd>


<dt id="arg-nice">nice<a class="anchor" aria-label="anchor" href="#arg-nice"></a></dt>
<dd><p>If set TRUE (default) output values are rounded and optimized for
publication tables.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>sc_bplm</code>.</p><table class="table table"><tr><td></td><td></td></tr><tr><td><code>model</code></td><td>List containing information about the applied model.</td></tr><tr><td><code>N</code></td><td>Number of single-cases.</td></tr><tr><td><code>formula</code></td><td>A list containing the fixed and the random formulas of the hplm model.</td></tr><tr><td><code>mcmglmm</code></td><td>Object of class MCMglmm.</td></tr><tr><td><code>contrast</code></td><td>List with contrast definitions.</td></tr></table></div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>

<ul><li><p><code>print(sc_bplm)</code>: Print results</p></li>
<li><p><code>export(sc_bplm)</code>: Export results as html table (see <code><a href="export.html">export()</a></code>)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other regression functions:
<code><a href="autocorr.html">autocorr</a>()</code>,
<code><a href="corrected_tau.html">corrected_tau</a>()</code>,
<code><a href="hplm.html">hplm</a>()</code>,
<code><a href="mplm.html">mplm</a>()</code>,
<code><a href="plm.html">plm</a>()</code>,
<code><a href="trend.html">trend</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Juergen Wilbert</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># plm regression</span></span></span>
<span class="r-in"><span><span class="fu">bplm</span><span class="op">(</span><span class="va">example_A24</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Piecewise Linear Regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrast model: W (level: first, slope: first)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deviance Information Criterion: 221.87 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B-structure - Fixed effects (injuries ~ 1 + year + phaseB + interB)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                               B lower 95% CI upper 95% CI sample size     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept               258.493      225.124      300.038    1192.152 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend (year)              2.032       -7.538       12.150    1000.000 0.666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B (phaseB) -150.934     -206.970     -104.339    1107.750 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B (interB)   -1.965      -11.167        9.533    1000.000 0.704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-Structure - Residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           SD lower 95% CI upper 95% CI </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       28.059       19.024       37.313 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multilevel plm regression with random intercept</span></span></span>
<span class="r-in"><span><span class="fu">bplm</span><span class="op">(</span><span class="va">exampleAB_50</span>, nitt <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Piecewise Linear Regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrast model: W (level: first, slope: first)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 Cases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deviance Information Criterion: 8574.425 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B-structure - Fixed effects (values ~ 1 + mt + phaseB + interB)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             B lower 95% CI upper 95% CI sample size     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept              48.444       45.747       51.379     200.000 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend (mt)              0.586        0.365        0.799     200.000 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B (phaseB) 14.004       12.886       15.080     198.408 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B (interB)  0.896        0.668        1.101     200.000 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G-Structure - Random effects (~case)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter     SD lower 95% CI upper 95% CI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Intercept 10.312        8.365       12.532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-Structure - Residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           SD lower 95% CI upper 95% CI </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        5.293        5.069        5.488 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Adding a random slope</span></span></span>
<span class="r-in"><span><span class="fu">bplm</span><span class="op">(</span><span class="va">exampleAB_50</span>, random_level <span class="op">=</span> <span class="cn">TRUE</span>, nitt <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bayesian Piecewise Linear Regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrast model: W (level: first, slope: first)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 Cases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deviance Information Criterion: 8459.847 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B-structure - Fixed effects (values ~ 1 + mt + phaseB + interB)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             B lower 95% CI upper 95% CI sample size     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept              48.249       45.233       50.582         200 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend (mt)              0.635        0.441        0.899         200 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B (phaseB) 13.813       11.856       15.178         200 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B (interB)  0.852        0.592        1.035         200 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G-Structure - Random effects (~us(1 + phaseB):case)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Parameter    SD lower 95% CI upper 95% CI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Intercept 9.778        8.105       11.397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Level phase B (phaseB) 3.985        2.900        5.059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         Parameter Correlation lower 95% CI upper 95% CI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Intercept:Level phase B (phaseB)       0.086       -0.203        0.498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-Structure - Residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           SD lower 95% CI upper 95% CI </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        5.017        4.811        5.177 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Juergen Wilbert, Timo Lueke.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

