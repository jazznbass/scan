<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Transform every single case of a single case data frame — moving_median • scan</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Transform every single case of a single case data frame — moving_median"><meta name="description" content="Takes an scdf and applies transformations to each individual case. This is
useful to calculate or modify new variables."><meta property="og:description" content="Takes an scdf and applies transformations to each individual case. This is
useful to calculate or modify new variables."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.65.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://jazznbass.github.io/scan-Book/">The book</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://jazznbass.github.io/scplot/">scplot</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/jazznbass/scan/"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Transform every single case of a single case data frame</h1>
      <small class="dont-index">Source: <a href="https://github.com/jazznbass/scan/blob/HEAD/R/transform-helper-functions.R" class="external-link"><code>R/transform-helper-functions.R</code></a>, <a href="https://github.com/jazznbass/scan/blob/HEAD/R/transform.scdf.R" class="external-link"><code>R/transform.scdf.R</code></a></small>
      <div class="d-none name"><code>transform.scdf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Takes an scdf and applies transformations to each individual case. This is
useful to calculate or modify new variables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">moving_median</span><span class="op">(</span><span class="va">x</span>, lag <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">moving_mean</span><span class="op">(</span><span class="va">x</span>, lag <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">local_regression</span><span class="op">(</span><span class="va">x</span>, mt <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, f <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">first_of</span><span class="op">(</span><span class="va">x</span>, positions <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">across_cases</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">all_cases</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rowwise</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'scdf'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">`_data`</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A logical vector.</p></dd>


<dt id="arg-lag">lag<a class="anchor" aria-label="anchor" href="#arg-lag"></a></dt>
<dd><p>Number of values surrounding a value to calculate the average</p></dd>


<dt id="arg-mt">mt<a class="anchor" aria-label="anchor" href="#arg-mt"></a></dt>
<dd><p>A vector with measurement times.</p></dd>


<dt id="arg-f">f<a class="anchor" aria-label="anchor" href="#arg-f"></a></dt>
<dd><p>the proportion of surrounding data influencing each data point.</p></dd>


<dt id="arg-positions">positions<a class="anchor" aria-label="anchor" href="#arg-positions"></a></dt>
<dd><p>A numeric vector with relative positions to the first
appearance of a TRUE value in x.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Expressions.</p></dd>


<dt id="arg--data">_data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>An scdf.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An scdf.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is a method of the generic transform function. Unlike the
generic function, it calculates expressions serially. This means that the
results of the calculation of one expression are the basis for the following
computations. The <code>n</code> function returns the number of measurements in a case.
The <code>all_cases</code> function is a helper function that extracts the values of a
variable from all cases. It takes an expression as an argument. For example,
<code>mean(all_cases(values))</code> calculates the mean of the values from all cases.
<code>mean(all_cases(values[phase == "A"]))</code> will calculate the mean of all values
where phase is A. <code>rowwise</code> applies a calculation separately for each row
(e.g. <code>sum = rowwise(sum(values, mt, na.rm = TRUE))</code>). The function
<code>across_cases</code> allows to calculate new variables or replace existing
variables across all cases. E.g., <code>across_cases(values_ranked = rank(values, na.last = "keep"))</code> will calculate a new variable with values ranked across
all cases.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other data manipulation functions:
<code><a href="add_l2.html">add_l2</a>()</code>,
<code><a href="as.data.frame.scdf.html">as.data.frame.scdf</a>()</code>,
<code><a href="as_scdf.html">as_scdf</a>()</code>,
<code><a href="fill_missing.html">fill_missing</a>()</code>,
<code><a href="outlier.html">outlier</a>()</code>,
<code><a href="ranks.html">ranks</a>()</code>,
<code><a href="rescale.html">rescale</a>()</code>,
<code><a href="scdf.html">scdf</a>()</code>,
<code><a href="select_cases.html">select_cases</a>()</code>,
<code><a href="set_vars.html">set_vars</a>()</code>,
<code><a href="shift.html">shift</a>()</code>,
<code><a href="smooth_cases.html">smooth_cases</a>()</code>,
<code><a href="standardize.html">standardize</a>()</code>,
<code><a href="truncate_phase.html">truncate_phase</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Creates a single-case with frequency distributions. The proportion and</span></span></span>
<span class="r-in"><span><span class="co">## percentage of the frequencies are calculated with transform:</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="design.html">design</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> n <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span> level <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span> distribution <span class="op">=</span> <span class="st">"binomial"</span>,</span></span>
<span class="r-in"><span> n_trials <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span> start_value <span class="op">=</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">study</span> <span class="op">&lt;-</span> <span class="fu"><a href="random_scdf.html">random_scdf</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">study</span>, proportion <span class="op">=</span> <span class="va">values</span><span class="op">/</span><span class="va">trials</span>, percentage <span class="op">=</span> <span class="va">proportion</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #A single-case data frame with three cases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Case1: phase values mt trials proportion percentage</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             A     12  1     20        0.6         60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             A     13  2     20       0.65         65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             A     11  3     20       0.55         55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             A      9  4     20       0.45         45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             A      9  5     20       0.45         45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             B     20  6     20          1        100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             B     20  7     20          1        100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             B     20  8     20          1        100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             B     20  9     20          1        100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             B     20 10     20          1        100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             B     20 11     20          1        100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             B     20 12     20          1        100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             B     20 13     20          1        100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             B     20 14     20          1        100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             B     20 15     20          1        100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # ... up to five more rows</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #  two more cases</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Z standardize the dependent variable and add two new variables:</span></span></span>
<span class="r-in"><span><span class="va">exampleAB</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    mean_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    sd_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #A single-case data frame with three cases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Johanna: values mt phase mean_values sd_values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            -1.31  1     A           0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             -1.4  2     A           0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            -1.14  3     A           0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            -0.97  4     A           0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            -1.48  5     A           0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            -0.71  6     B           0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            -0.62  7     B           0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0.15  8     B           0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            -0.28  9     B           0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            -0.45 10     B           0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0.75 11     B           0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0.06 12     B           0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0.41 13     B           0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              1.1 14     B           0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0.67 15     B           0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # ... up to five more rows</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #  two more cases</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Use `all` to calculate global variables.</span></span></span>
<span class="r-in"><span><span class="va">exampleAB</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    values_center_case <span class="op">=</span> <span class="va">values</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">values</span><span class="op">[</span><span class="va">phase</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    values_center_global <span class="op">=</span> <span class="va">values</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">values</span><span class="op">[</span><span class="va">phase</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    value_dif <span class="op">=</span> <span class="va">values_center_case</span> <span class="op">-</span> <span class="va">values_center_global</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #A single-case data frame with three cases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Johanna: values mt phase values_center_case values_center_global value_dif</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               54  1     A               -0.6                 0.67     -1.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               53  2     A               -1.6                -0.33     -1.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               56  3     A                1.4                 2.67     -1.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               58  4     A                3.4                 4.67     -1.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               52  5     A               -2.6                -1.33     -1.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               61  6     B                6.4                 7.67     -1.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               62  7     B                7.4                 8.67     -1.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               71  8     B               16.4                17.67     -1.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               66  9     B               11.4                12.67     -1.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               64 10     B                9.4                10.67     -1.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               78 11     B               23.4                24.67     -1.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               70 12     B               15.4                16.67     -1.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               74 13     B               19.4                20.67     -1.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               82 14     B               27.4                28.67     -1.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               77 15     B               22.4                23.67     -1.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # ... up to five more rows</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #  two more cases</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Use `across_cases` to calculate or replace a variable with values from</span></span></span>
<span class="r-in"><span><span class="co">## all cases. E.g., standardize the dependent variable:</span></span></span>
<span class="r-in"><span><span class="va">exampleABC</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">across_cases</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #A single-case data frame with three cases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Marie: values mt phase │ Rosalind: values mt phase │ Lise: values mt phase │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -0.24  1     A │            -1.02  1     A │        -0.81  1     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -0.39  2     A │            -1.45  2     A │        -1.16  2     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           -0.1  3     A │            -1.02  3     A │         0.11  3     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           0.11  4     A │            -0.67  4     A │         -0.6  4     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -0.74  5     A │            -0.53  5     A │         0.32  5     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -1.16  6     A │             0.25  6     A │        -0.32  6     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -1.23  7     A │            -0.46  7     A │        -1.87  7     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -0.17  8     A │            -1.73  8     A │        -1.16  8     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -1.16  9     A │            -0.74  9     A │         0.88  9     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -1.59 10     A │             -0.1 10     A │         0.11 10     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1.52 11     B │             -0.1 11     A │        -1.02 11     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           0.25 12     B │             0.25 12     A │        -1.16 12     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            0.6 13     B │            -0.46 13     A │        -1.02 13     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1.52 14     B │            -1.09 14     A │         -1.8 14     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            0.6 15     B │            -0.88 15     A │        -0.74 15     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # ... up to 15 more rows</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Rank transform the values based on all cases vs. within each case:</span></span></span>
<span class="r-in"><span><span class="va">exampleABC</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">across_cases</span><span class="op">(</span>values_across <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="va">values</span>, na.last<span class="op">=</span><span class="st">"keep"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    value_within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="va">values</span>, na.last<span class="op">=</span><span class="st">"keep"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #A single-case data frame with three cases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Marie: values mt phase values_across value_within</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             58  1     A            40           11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             56  2     A          37.5          9.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             60  3     A          44.5           13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             63  4     A            50         14.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             51  5     A          23.5          6.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             45  6     A            10          3.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             44  7     A             7            2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             59  8     A          41.5           12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             45  9     A            10          3.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             39 10     A             5            1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             83 11     B            82           27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             65 12     B            55           16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             70 13     B          65.5         20.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             83 14     B            82           27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             70 15     B          65.5         20.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # ... up to 15 more rows</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #  two more cases</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Three helper functions to smooth the data</span></span></span>
<span class="r-in"><span><span class="va">Huber2014</span><span class="op">$</span><span class="va">Berta</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"compliance (moving median)"</span> <span class="op">=</span> <span class="fu">moving_median</span><span class="op">(</span><span class="va">compliance</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"compliance (moving mean)"</span> <span class="op">=</span> <span class="fu">moving_mean</span><span class="op">(</span><span class="va">compliance</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"compliance (local regression)"</span> <span class="op">=</span> <span class="fu">local_regression</span><span class="op">(</span><span class="va">compliance</span>, <span class="va">mt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #A single-case data frame with one case</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Berta: compliance mt phase compliance (moving median) compliance (moving mean)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 25  1     A                         25                       25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               20.8  2     A                         25                    28.47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               39.6  3     A                       39.6                    47.69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 75  4     A                         45                     55.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 45  5     A                         45                     38.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               14.6  6     A                         45                    32.97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               45.8  7     A                         45                    37.36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               33.3  8     A                       33.3                    33.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               31.3  9     A                       32.5                     32.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               32.5 10     A                       32.5                     23.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                4.2 11     B                       32.5                    24.37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               45.8 12     B                       32.5                    33.82</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               31.3 13     B                       31.3                    24.84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                9.4 14     B                        9.4                    13.51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                6.3 15     B                        6.3                        8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  compliance (local regression)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          22.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          28.81</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           39.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           42.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           45.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           45.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          36.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           32.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           32.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          39.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           45.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          29.41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          15.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           6.58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # ... up to 14 more rows</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Function first_of() helps to set NAs for specific phases.</span></span></span>
<span class="r-in"><span><span class="co">## E.g., you want to replace the first two values of phase A and the first</span></span></span>
<span class="r-in"><span><span class="co">## value of phase B and its preceding value.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">byHeart2011</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">values</span>, <span class="fu">first_of</span><span class="op">(</span><span class="va">phase</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">values</span>, <span class="fu">first_of</span><span class="op">(</span><span class="va">phase</span> <span class="op">==</span> <span class="st">"B"</span>, <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">0</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #A single-case data frame with 11 cases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Lisa (Turkish): values mt phase │ Patrick (Spanish): values mt phase │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    &lt;NA&gt;  1     A │                      &lt;NA&gt;  1     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    &lt;NA&gt;  2     A │                      &lt;NA&gt;  2     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       0  3     A │                         3  3     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       0  4     A │                         0  4     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    &lt;NA&gt;  5     A │                      &lt;NA&gt;  5     A │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    &lt;NA&gt;  6     B │                      &lt;NA&gt;  6     B │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       5  7     B │                         8  7     B │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       6  8     B │                         8  8     B │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       7  9     B │                         8  9     B │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      10 10     B │                        12 10     B │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      10 11     B │                        13 11     B │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      15 12     B │                        13 12     B │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      16 13     B │                        15 13     B │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      14 14     B │                        14 14     B │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      17 15     B │                        15 15     B │</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # ... up to 11 more rows</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #  nine more cases</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Juergen Wilbert, Timo Lueke.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

