<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Trend analysis for single-cases data — trend • scan</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Trend analysis for single-cases data — trend"><meta name="description" content="The trend() function provides an overview of linear trends in single case
data. By default, it provides the intercept and slope of a linear and
quadratic regression of measurement time on scores. Models are calculated
separately for each phase and across all phases. For more advanced use, you
can add regression models using the R-specific formula class."><meta property="og:description" content="The trend() function provides an overview of linear trends in single case
data. By default, it provides the intercept and slope of a linear and
quadratic regression of measurement time on scores. Models are calculated
separately for each phase and across all phases. For more advanced use, you
can add regression models using the R-specific formula class."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.65.999</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://jazznbass.github.io/scan-Book/">The book</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://jazznbass.github.io/scplot/">scplot</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/jazznbass/scan/"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Trend analysis for single-cases data</h1>
      <small class="dont-index">Source: <a href="https://github.com/jazznbass/scan/blob/HEAD/R/trend.R" class="external-link"><code>R/trend.R</code></a></small>
      <div class="d-none name"><code>trend.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>trend()</code> function provides an overview of linear trends in single case
data. By default, it provides the intercept and slope of a linear and
quadratic regression of measurement time on scores. Models are calculated
separately for each phase and across all phases. For more advanced use, you
can add regression models using the R-specific formula class.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">trend</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">dvar</span>,</span>
<span>  <span class="va">pvar</span>,</span>
<span>  <span class="va">mvar</span>,</span>
<span>  offset <span class="op">=</span> <span class="st">"deprecated"</span>,</span>
<span>  first_mt <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A single-case data frame. See <code><a href="scdf.html">scdf()</a></code> to learn about this
format.</p></dd>


<dt id="arg-dvar">dvar<a class="anchor" aria-label="anchor" href="#arg-dvar"></a></dt>
<dd><p>Character string with the name of the dependent variable.
Defaults to the attributes in the scdf file.</p></dd>


<dt id="arg-pvar">pvar<a class="anchor" aria-label="anchor" href="#arg-pvar"></a></dt>
<dd><p>Character string with the name of the phase variable. Defaults to
the attributes in the scdf file.</p></dd>


<dt id="arg-mvar">mvar<a class="anchor" aria-label="anchor" href="#arg-mvar"></a></dt>
<dd><p>Character string with the name of the measurement time variable.
Defaults to the attributes in the scdf file.</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>(Deprecated. Please use first_mt). An offset for the first
measurement-time of each phase. If <code>offset = 0</code>, the phase measurement is
handled as MT 1. Default is <code>offset = -1</code>, setting the first value of MT to
0.</p></dd>


<dt id="arg-first-mt">first_mt<a class="anchor" aria-label="anchor" href="#arg-first-mt"></a></dt>
<dd><p>A numeric setting the value for the first measurement-time.
Default = 0.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A string or a list of (named) strings each depicting one
regression model. This is a formula expression of the standard R class. The
parameters of the model are <code>values</code>, <code>mt</code> and <code>phase</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<dl><dt>trend</dt>
<dd><p>A matrix containing the results (Intercept, B and beta)
of separate regression models for phase A, phase B, and the whole data.</p></dd>

<dt>first_mt</dt>
<dd><p>Numeric argument from function call (see arguments
section).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="describe.html">describe()</a></code></p>
<p>Other regression functions:
<code><a href="autocorr.html">autocorr</a>()</code>,
<code><a href="bplm.html">bplm</a>()</code>,
<code><a href="corrected_tau.html">corrected_tau</a>()</code>,
<code><a href="hplm.html">hplm</a>()</code>,
<code><a href="mplm.html">mplm</a>()</code>,
<code><a href="plm.html">plm</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Juergen Wilbert</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Compute the linear and squared regression for a random single-case</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="design.html">design</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">matthea</span> <span class="op">&lt;-</span> <span class="fu"><a href="random_scdf.html">random_scdf</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">trend</span><span class="op">(</span><span class="va">matthea</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend for each phase</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Intercept     B  Beta</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear.ALL       41.504 4.159 0.957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear.A         50.958 0.750 0.320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear.B         57.269 4.751 0.946</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Quadratic.ALL    54.904 0.211 0.958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Quadratic.A      52.085 0.062 0.110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Quadratic.B      68.993 0.318 0.920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Note. Measurement-times start at 0 for each phase</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Besides the linear and squared regression models compute two custom models:</span></span></span>
<span class="r-in"><span><span class="co">## a) a cubic model, and </span></span></span>
<span class="r-in"><span><span class="co">## b) the values predicted by the natural logarithm of the</span></span></span>
<span class="r-in"><span><span class="co">## measurement time.</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="design.html">design</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ben</span> <span class="op">&lt;-</span> <span class="fu"><a href="random_scdf.html">random_scdf</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">trend</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">ben</span>, </span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Cubic"</span> <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">mt</span><span class="op">^</span><span class="fl">3</span>, <span class="st">"Log Time"</span> <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">mt</span><span class="op">)</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  first_mt <span class="op">=</span> <span class="fl">1</span> <span class="co"># must be set to 1 because log(0) would be -Inf</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend for each phase</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Intercept      B   Beta</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear.ALL       43.260  2.417  0.898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear.A         56.353 -0.794 -0.272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear.B         48.333  3.149  0.918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Quadratic.ALL    52.101  0.115  0.926</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Quadratic.A      56.289 -0.211 -0.441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Quadratic.B      58.126  0.186  0.893</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cubic.ALL        43.260  2.417  0.898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cubic.A          56.353 -0.794 -0.272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cubic.B          48.333  3.149  0.918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log Time.ALL     37.394 14.760  0.753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log Time.A       54.527 -0.581 -0.080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log Time.B       42.725 16.561  0.844</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Note. Measurement-times start at 1 for each phase</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Juergen Wilbert, Timo Lueke.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

