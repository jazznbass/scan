<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Piecewise linear model / piecewise regression — plm • scan</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Piecewise linear model / piecewise regression — plm"><meta name="description" content="The plm function computes a piecewise regression model (see Huitema &amp;amp;
McKean, 2000)."><meta property="og:description" content="The plm function computes a piecewise regression model (see Huitema &amp;amp;
McKean, 2000)."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.62.999</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://jazznbass.github.io/scan-Book/">The book</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://jazznbass.github.io/scplot/">scplot</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/jazznbass/scan/"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Piecewise linear model / piecewise regression</h1>
      <small class="dont-index">Source: <a href="https://github.com/jazznbass/scan/blob/HEAD/R/plm.R" class="external-link"><code>R/plm.R</code></a></small>
      <div class="d-none name"><code>plm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>plm</code> function computes a piecewise regression model (see Huitema &amp;
McKean, 2000).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plm</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">dvar</span>,</span>
<span>  <span class="va">pvar</span>,</span>
<span>  <span class="va">mvar</span>,</span>
<span>  AR <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"W"</span>, <span class="st">"H-M"</span>, <span class="st">"B&amp;L-B"</span>, <span class="st">"JW"</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  trend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  level <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  slope <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"first"</span>, <span class="st">"preceding"</span><span class="op">)</span>,</span>
<span>  contrast_level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"first"</span>, <span class="st">"preceding"</span><span class="op">)</span>,</span>
<span>  contrast_slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"first"</span>, <span class="st">"preceding"</span><span class="op">)</span>,</span>
<span>  formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  update <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>  r_squared <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  var_trials <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dvar_percentage <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A single-case data frame. See <code><a href="scdf.html">scdf()</a></code> to learn about this
format.</p></dd>


<dt id="arg-dvar">dvar<a class="anchor" aria-label="anchor" href="#arg-dvar"></a></dt>
<dd><p>Character string with the name of the dependent variable.
Defaults to the attributes in the scdf file.</p></dd>


<dt id="arg-pvar">pvar<a class="anchor" aria-label="anchor" href="#arg-pvar"></a></dt>
<dd><p>Character string with the name of the phase variable. Defaults to
the attributes in the scdf file.</p></dd>


<dt id="arg-mvar">mvar<a class="anchor" aria-label="anchor" href="#arg-mvar"></a></dt>
<dd><p>Character string with the name of the measurement time variable.
Defaults to the attributes in the scdf file.</p></dd>


<dt id="arg-ar">AR<a class="anchor" aria-label="anchor" href="#arg-ar"></a></dt>
<dd><p>Maximal lag of autoregression. Modelled based on the
Autoregressive-Moving Average (ARMA) function.  When AR is set, the family
argument must be set to <code>family = "gaussian"</code>.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Model used for calculating the dummy parameters (see Huitema &amp;
McKean, 2000). Default is <code>model = "W"</code>. Possible values are: <code>"B&amp;L-B"</code>,
<code>"H-M"</code>, <code>"W"</code>, and deprecated <code>"JW"</code>.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>Set the distribution family. Defaults to a gaussian
distribution. See the <code>family</code> function for more details.</p></dd>


<dt id="arg-trend">trend<a class="anchor" aria-label="anchor" href="#arg-trend"></a></dt>
<dd><p>A logical indicating if a trend parameters is included in the
model.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>A logical indicating if a level parameters is included in the
model.</p></dd>


<dt id="arg-slope">slope<a class="anchor" aria-label="anchor" href="#arg-slope"></a></dt>
<dd><p>A logical indicating if a slope parameters is included in the
model.</p></dd>


<dt id="arg-contrast">contrast<a class="anchor" aria-label="anchor" href="#arg-contrast"></a></dt>
<dd><p>Sets contrast_level and contrast_slope. Either "first",
"preceding" or a contrast matrix.</p></dd>


<dt id="arg-contrast-level">contrast_level<a class="anchor" aria-label="anchor" href="#arg-contrast-level"></a></dt>
<dd><p>Either "first", "preceding" or a contrast matrix. If NA
contrast_level is a copy of contrast.</p></dd>


<dt id="arg-contrast-slope">contrast_slope<a class="anchor" aria-label="anchor" href="#arg-contrast-slope"></a></dt>
<dd><p>Either "first", "preceding" or a contrast matrix. If NA
contrast_level is a copy of contrast.</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>Defaults to the standard piecewise regression model. The
parameter phase followed by the phase name (e.g., phaseB) indicates the
level effect of the corresponding phase. The parameter 'inter' followed by
the phase name (e.g., interB) adresses the slope effect based on the method
provide in the model argument (e.g., "B&amp;L-B"). The formula can be changed
for example to include further variables into the regression model.</p></dd>


<dt id="arg-update">update<a class="anchor" aria-label="anchor" href="#arg-update"></a></dt>
<dd><p>An easier way to change the regression formula (e.g., <code>. ~ . + newvariable</code>).</p></dd>


<dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>Defines how to deal with missing values.</p></dd>


<dt id="arg-r-squared">r_squared<a class="anchor" aria-label="anchor" href="#arg-r-squared"></a></dt>
<dd><p>Logical. If TRUE, delta r_squares will be calculated for
each predictor.</p></dd>


<dt id="arg-var-trials">var_trials<a class="anchor" aria-label="anchor" href="#arg-var-trials"></a></dt>
<dd><p>Name of the variable containing the number of trials (only
for binomial regressions). If a single integer is provided this is
considered to be a the constant number of trials across all measurements.</p></dd>


<dt id="arg-dvar-percentage">dvar_percentage<a class="anchor" aria-label="anchor" href="#arg-dvar-percentage"></a></dt>
<dd><p>Only for binomial distribution. If set TRUE, the
dependent variable is assumed to represent proportions <code>[0,1]</code>. Otherwise
dvar is assumed to represent counts.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to the glm function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<dl><dt>formula</dt>
<dd><p>plm formula. Uselful if you want to use the update or
formula argument and you don't know the names of the parameters.</p></dd>

<dt>model</dt>
<dd><p>Character string from function call (see <code>Arguments</code>
above).</p></dd>

<dt>F.test</dt>
<dd><p>F-test values of modelfit.</p></dd>
 <dt>r.squares</dt>
<dd><p>Explained variance
R squared for each model parameter.</p></dd>

<dt>ar</dt>
<dd><p>Autoregression lag from function call (see <code>Arguments</code>
above).</p></dd>

<dt>family</dt>
<dd><p>Distribution family from function call
(see <code>Arguments</code> above).</p></dd>

<dt>full.model</dt>
<dd><p>Full regression model list from the gls or glm function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Beretvas, S., &amp; Chung, H. (2008). An evaluation of modified
R2-change effect size indices for single-subject experimental designs.
<em>Evidence-Based Communication Assessment and Intervention, 2</em>,
120-128.</p>
<p>Huitema, B. E., &amp; McKean, J. W. (2000). Design specification issues in
time-series intervention models. <em>Educational and Psychological
Measurement, 60</em>, 38-58.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other regression functions:
<code><a href="autocorr.html">autocorr</a>()</code>,
<code><a href="bplm.html">bplm</a>()</code>,
<code><a href="corrected_tau.html">corrected_tau</a>()</code>,
<code><a href="hplm.html">hplm</a>()</code>,
<code><a href="mplm.html">mplm</a>()</code>,
<code><a href="trend.html">trend</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Juergen Wilbert</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Compute a piecewise regression model for a random single-case</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">AB</span> <span class="op">&lt;-</span> <span class="fu"><a href="design.html">design</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  phase_design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">10</span>, B <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">0</span>, B <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">0</span>, B <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  trend <span class="op">=</span> <span class="fl">0.05</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="random_scdf.html">random_scdf</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">AB</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plm</span><span class="op">(</span><span class="va">dat</span>, AR <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Piecewise Regression Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrast model: W / level = first, slope = first</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted a gaussian distribution.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlated residuals up to autoregressions of lag 3 are modelled</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F(3, 26) = 47.38; p = 0.000; R² = 0.845; Adjusted R² = 0.828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             B   2.5%  97.5%    SE      t     p delta R²</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept              53.068 48.188 57.948 2.490 21.315 0.000         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend (mt)             -0.166 -1.032  0.701 0.442 -0.374 0.711   -0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B (phaseB) 16.266 10.061 22.470 3.166  5.138 0.000    0.069</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B (interB)  0.913 -0.045  1.871 0.489  1.869 0.073    0.016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Autocorrelations of the residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  lag    cr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1 -0.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2 -0.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3  0.38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: values ~ 1 + mt + phaseB + interB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Another example with a more complex design</span></span></span>
<span class="r-in"><span><span class="va">A1B1A2B2</span> <span class="op">&lt;-</span> <span class="fu"><a href="design.html">design</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  phase_design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A1 <span class="op">=</span> <span class="fl">15</span>, B1 <span class="op">=</span> <span class="fl">20</span>, A2 <span class="op">=</span> <span class="fl">15</span>, B2 <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A1 <span class="op">=</span> <span class="fl">0</span>, B1 <span class="op">=</span> <span class="fl">1</span>, A2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, B2 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A1 <span class="op">=</span> <span class="fl">0</span>, B1 <span class="op">=</span> <span class="fl">0.0</span>, A2 <span class="op">=</span> <span class="fl">0</span>, B2 <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  trend <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="random_scdf.html">random_scdf</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">A1B1A2B2</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plm</span><span class="op">(</span><span class="va">dat</span>, contrast <span class="op">=</span> <span class="st">"preceding"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Piecewise Regression Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrast model: W / level = preceding, slope = preceding</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted a gaussian distribution.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F(7, 62) = 11.05; p = 0.000; R² = 0.555; Adjusted R² = 0.505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                B    2.5%  97.5%    SE      t     p delta R²</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept                 51.354  46.820 55.889 2.314 22.196 0.000         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend (mt)                -0.085  -0.636  0.467 0.281 -0.301 0.764    0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B1 (phaseB1)   7.816   1.418 14.213 3.264  2.395 0.020    0.041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase A2 (phaseA2) -11.360 -17.599 -5.121 3.183 -3.569 0.001    0.091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B2 (phaseB2)  10.380   3.983 16.777 3.264  3.180 0.002    0.073</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B1 (interB1)   0.280  -0.377  0.937 0.335  0.835 0.407    0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase A2 (interA2)  -0.240  -0.897  0.417 0.335 -0.716 0.477    0.004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B2 (interB2)   0.119  -0.538  0.776 0.335  0.354 0.724    0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Autocorrelations of the residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  lag    cr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1 -0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2 -0.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3  0.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ljung-Box test: X²(3) = 2.27; p = 0.519 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: values ~ 1 + mt + phaseB1 + phaseA2 + phaseB2 + interB1 + interA2 + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     interB2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## no slope effects were found. Therefore, you might want to the drop slope</span></span></span>
<span class="r-in"><span><span class="co">## estimation:</span></span></span>
<span class="r-in"><span><span class="fu">plm</span><span class="op">(</span><span class="va">dat</span>, slope <span class="op">=</span> <span class="cn">FALSE</span>, contrast <span class="op">=</span> <span class="st">"preceding"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Piecewise Regression Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrast model: W / level = preceding, slope = preceding</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted a gaussian distribution.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F(4, 65) = 19.73; p = 0.000; R² = 0.548; Adjusted R² = 0.521</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                B    2.5%  97.5%    SE      t     p delta R²</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept                 50.232  47.470 52.994 1.409 35.645 0.000         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend (mt)                 0.076  -0.133  0.284 0.107  0.710 0.480    0.004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B1 (phaseB1)   7.671   2.879 12.463 2.445  3.137 0.003    0.068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase A2 (phaseA2) -10.945 -15.737 -6.153 2.445 -4.477 0.000    0.139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B2 (phaseB2)   9.402   4.610 14.194 2.445  3.846 0.000    0.103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Autocorrelations of the residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  lag    cr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1 -0.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2 -0.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3  0.13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ljung-Box test: X²(3) = 2.02; p = 0.568 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: values ~ 1 + mt + phaseB1 + phaseA2 + phaseB2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## and now drop the trend estimation as well</span></span></span>
<span class="r-in"><span><span class="fu">plm</span><span class="op">(</span><span class="va">dat</span>, slope <span class="op">=</span> <span class="cn">FALSE</span>, trend <span class="op">=</span> <span class="cn">FALSE</span>, contrast <span class="op">=</span> <span class="st">"preceding"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Piecewise Regression Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrast model: W / level = preceding, slope = preceding</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted a gaussian distribution.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F(3, 66) = 26.34; p = 0.000; R² = 0.545; Adjusted R² = 0.524</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                               B    2.5%  97.5%    SE      t p delta R²</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept                50.762  48.427 53.097 1.191 42.611 0         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B1 (phaseB1)  8.995   5.906 12.084 1.576  5.708 0    0.225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase A2 (phaseA2) -9.621 -12.710 -6.532 1.576 -6.105 0    0.257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B2 (phaseB2) 10.726   7.637 13.815 1.576  6.806 0    0.319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Autocorrelations of the residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  lag    cr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1 -0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2 -0.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3  0.13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ljung-Box test: X²(3) = 1.82; p = 0.611 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: values ~ 1 + phaseB1 + phaseA2 + phaseB2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A poisson regression</span></span></span>
<span class="r-in"><span><span class="va">example_A24</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">plm</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Piecewise Regression Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrast model: W / level = first, slope = first</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted a poisson distribution.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X²(3) = 547.67; p = 0.000; AIC = 261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             B   2.5%  97.5%    SE       t     p      OR    2.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept               5.556  5.472  5.638 0.042 131.693 0.000 258.786 237.936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend (year)            0.007 -0.016  0.030 0.012   0.604 0.546   1.007   0.984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B (phaseB) -0.806 -0.938 -0.674 0.067 -11.964 0.000   0.447   0.391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B (interB) -0.006 -0.031  0.019 0.013  -0.472 0.637   0.994   0.969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept              280.900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend (year)             1.030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B (phaseB)   0.510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B (interB)   1.019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: injuries ~ 1 + year + phaseB + interB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A binomial regression (frequencies as dependent variable)</span></span></span>
<span class="r-in"><span><span class="fu">plm</span><span class="op">(</span><span class="va">exampleAB_score</span><span class="op">$</span><span class="va">Christiano</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, var_trials <span class="op">=</span> <span class="st">"trials"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Piecewise Regression Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrast model: W / level = first, slope = first</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted a binomial distribution.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X²(3) = 240.66; p = 0.000; AIC = 120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             B   2.5%  97.5%    SE      t     p     OR  2.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept              -1.964 -2.793 -1.239 0.394 -4.991 0.000  0.140 0.061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend (mt)              0.023 -0.118  0.166 0.072  0.324 0.746  1.023 0.889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B (phaseB)  2.376  1.454  3.378 0.488  4.866 0.000 10.762 4.280</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B (interB)  0.038 -0.111  0.186 0.075  0.504 0.614  1.039 0.895</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept               0.290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend (mt)              1.181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B (phaseB) 29.312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B (interB)  1.204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: values/trials ~ 1 + mt + phaseB + interB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> weights = trials</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A binomial regression (percentage as dependent variable)</span></span></span>
<span class="r-in"><span><span class="va">exampleAB_score</span><span class="op">$</span><span class="va">Christiano</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>percentage <span class="op">=</span> <span class="va">values</span><span class="op">/</span><span class="va">trials</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="set_vars.html">set_dvar</a></span><span class="op">(</span><span class="st">"percentage"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">plm</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"binomial"</span>, var_trials <span class="op">=</span> <span class="st">"trials"</span>, dvar_percentage <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Piecewise Regression Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contrast model: W / level = first, slope = first</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted a binomial distribution.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X²(3) = 240.66; p = 0.000; AIC = 120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             B   2.5%  97.5%    SE      t     p     OR  2.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept              -1.964 -2.793 -1.239 0.394 -4.991 0.000  0.140 0.061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend (mt)              0.023 -0.118  0.166 0.072  0.324 0.746  1.023 0.889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B (phaseB)  2.376  1.454  3.378 0.488  4.866 0.000 10.762 4.280</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B (interB)  0.038 -0.111  0.186 0.075  0.504 0.614  1.039 0.895</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept               0.290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend (mt)              1.181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B (phaseB) 29.312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B (interB)  1.204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: percentage ~ 1 + mt + phaseB + interB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> weights = trials</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Juergen Wilbert, Timo Lueke.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

